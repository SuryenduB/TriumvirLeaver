<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Workflow PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Workflow created="1468355703242" explicitTransitions="true" id="4028f68155e05c970155e0d1f1ca0015" modified="1469725265345" name="Triumvir_Standard_Leaver_Process">
  <Variable input="true" name="launcher"/>
  <Variable input="true" name="quickLinkIdentityId"/>
  <Variable input="true" name="request"/>
  <Variable initializer="script:identityName = launcher;" name="identityName"/>
  <Variable input="true" name="plan"/>
  <Description>Workflow to handle the leaves process</Description>
  <Step icon="Start" monitored="true" name="Start" posX="99" posY="72">
    <Transition to="Init"/>
  </Step>
  <Step icon="Task" monitored="true" name="Init" posX="236" posY="72">
    <Transition to="CreateSnapshot">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("create-snapshot");

    if ("yes".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
    <Transition to="DisableAccounts">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("create-snapshot");

    if ("no".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
  </Step>
  <Step action="rule:Identity_Snapshot" icon="Task" monitored="true" name="CreateSnapshot" posX="449" posY="69">
    <Transition to="DisableAccounts"/>
  </Step>
  <Step icon="Provision" monitored="true" name="ProvisioningAccounts" posX="679" posY="171">
    <Arg name="identityEmailTemplate"/>
    <Arg name="enableRetryRequest"/>
    <Arg name="securityOfficerElectronicSignature"/>
    <Arg name="fallbackApprover"/>
    <Arg name="endOnManualWorkItems"/>
    <Arg name="userEmailTemplate"/>
    <Arg name="policiesToCheck"/>
    <Arg name="project"/>
    <Arg name="workItemComments"/>
    <Arg name="identityRequestId"/>
    <Arg name="approvalSplitPoint"/>
    <Arg name="source"/>
    <Arg name="identityDisplayName"/>
    <Arg name="foregroundProvisioning" value="true"/>
    <Arg name="ownerElectronicSignature"/>
    <Arg name="batchRequestItemId"/>
    <Arg name="splitPlans"/>
    <Arg name="doRefresh" value="true"/>
    <Arg name="plan" value="ref:plan"/>
    <Arg name="flow"/>
    <Arg name="identityElectronicSignature"/>
    <Arg name="identityName" value="ref:identityName"/>
    <Arg name="approvalSet"/>
    <Arg name="violationReviewDecision"/>
    <Arg name="filterRejects"/>
    <Arg name="splitProjects"/>
    <Arg name="requesterEmailTemplate" value="Access Request Reminder"/>
    <Arg name="approvalEmailTemplate" value="LCM Manager Notification"/>
    <Arg name="ticketManagementApplication"/>
    <Arg name="securityOfficerName"/>
    <Arg name="approvingIdentities"/>
    <Arg name="managerEmailTemplate"/>
    <Arg name="ticketId"/>
    <Arg name="approvalScheme" value="none"/>
    <Arg name="allowRequestsWithViolations"/>
    <Arg name="workItemPriority" value="High"/>
    <Arg name="managerElectronicSignature"/>
    <Arg name="requireViolationReviewComments"/>
    <Arg name="splitApprovalSet"/>
    <Arg name="approvalMode"/>
    <Arg name="trace" value="true"/>
    <Arg name="endOnProvisioningForms"/>
    <Arg name="splitWorkItemComments"/>
    <Arg name="notificationScheme" value="requester"/>
    <Arg name="policyViolations"/>
    <Arg name="policyScheme" value="fail"/>
    <Arg name="setPreviousApprovalDecisions"/>
    <Arg name="optimisticProvisioning"/>
    <Arg name="securityOfficerEmailTemplate"/>
    <WorkflowRef>
      <Reference class="sailpoint.object.Workflow" id="4028f6815360fa48015360fcafc5003d" name="LCM Provisioning"/>
    </WorkflowRef>
    <Transition to="RemoveEntitlements"/>
  </Step>
  <Step icon="Catches" monitored="true" name="DisableAccounts" posX="313" posY="205">
    <Transition to="AccountsPlan">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("disable-accounts");

    if ("yes".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
    <Transition to="RemoveEntitlements">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("disable-accounts");

    if ("no".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
  </Step>
  <Step icon="Catches" monitored="true" name="RemoveEntitlements" posX="510" posY="283">
    <Transition to="EntitlementsPlan">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("delete-entitlement");

    if ("yes".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
    <Transition to="ManualWorkFlow">
      <Script>
        <Source>import sailpoint.object.Custom;

    Custom simpleChoise = context.getObjectByName(Custom.class, "Triumvir-standard-leaver");
    String choise = simpleChoise.get("delete-entitlement");

    if ("no".equals(choise))
        return true;
</Source>
      </Script>
    </Transition>
  </Step>
  <Step icon="Provision" monitored="true" name="ProvisioningEntitlements" posX="946" posY="277">
    <Arg name="identityEmailTemplate"/>
    <Arg name="enableRetryRequest"/>
    <Arg name="securityOfficerElectronicSignature"/>
    <Arg name="fallbackApprover"/>
    <Arg name="endOnManualWorkItems"/>
    <Arg name="userEmailTemplate"/>
    <Arg name="policiesToCheck"/>
    <Arg name="project"/>
    <Arg name="workItemComments"/>
    <Arg name="identityRequestId"/>
    <Arg name="approvalSplitPoint"/>
    <Arg name="source"/>
    <Arg name="identityDisplayName"/>
    <Arg name="foregroundProvisioning" value="true"/>
    <Arg name="ownerElectronicSignature"/>
    <Arg name="batchRequestItemId"/>
    <Arg name="splitPlans"/>
    <Arg name="doRefresh" value="true"/>
    <Arg name="plan" value="ref:plan"/>
    <Arg name="flow"/>
    <Arg name="identityElectronicSignature"/>
    <Arg name="identityName" value="ref:identityName"/>
    <Arg name="approvalSet"/>
    <Arg name="violationReviewDecision"/>
    <Arg name="filterRejects"/>
    <Arg name="splitProjects"/>
    <Arg name="requesterEmailTemplate"/>
    <Arg name="approvalEmailTemplate" value="LCM Manager Notification"/>
    <Arg name="ticketManagementApplication"/>
    <Arg name="securityOfficerName"/>
    <Arg name="approvingIdentities"/>
    <Arg name="managerEmailTemplate"/>
    <Arg name="ticketId"/>
    <Arg name="approvalScheme" value="none"/>
    <Arg name="allowRequestsWithViolations"/>
    <Arg name="workItemPriority" value="High"/>
    <Arg name="managerElectronicSignature"/>
    <Arg name="requireViolationReviewComments"/>
    <Arg name="splitApprovalSet"/>
    <Arg name="approvalMode"/>
    <Arg name="trace" value="true"/>
    <Arg name="endOnProvisioningForms"/>
    <Arg name="splitWorkItemComments"/>
    <Arg name="notificationScheme" value="requester"/>
    <Arg name="policyViolations"/>
    <Arg name="policyScheme" value="fail"/>
    <Arg name="setPreviousApprovalDecisions"/>
    <Arg name="optimisticProvisioning"/>
    <Arg name="securityOfficerEmailTemplate"/>
    <WorkflowRef>
      <Reference class="sailpoint.object.Workflow" id="4028f6815360fa48015360fcafc5003d" name="LCM Provisioning"/>
    </WorkflowRef>
    <Transition to="Stop"/>
  </Step>
  <Step action="rule:8a81811b56292cfa0156292f6fde0019" icon="Default" monitored="true" name="ManualWorkFlow" posX="676" posY="413" resultVariable="plan">
    <Transition to="Generic Step"/>
  </Step>
  <Step icon="Stop" monitored="true" name="Stop" posX="1130" posY="273"/>
  <Step action="rule:Disable_accounts" icon="Default" monitored="true" name="AccountsPlan" posX="571" posY="163" resultVariable="plan">
    <Transition to="ProvisioningAccounts"/>
  </Step>
  <Step action="rule:Delete_Entitlements" icon="Default" monitored="true" name="EntitlementsPlan" posX="789" posY="274" resultVariable="plan">
    <Transition to="ProvisioningEntitlements"/>
  </Step>
  <Step icon="Default" monitored="true" name="Generic Step" posX="802" posY="468">
    <Transition to="ResetPassword"/>
  </Step>
  <Step action="rule:Change_Password" icon="Default" monitored="true" name="ResetPassword" posX="993" posY="464"/>
</Workflow>
